!function(o,a){"use strict";var e,i;function l(t){var o=[];o.push('<option value="">{0}</option>'.format("All Steps"));var r=i[t];return a.each(r,function(t,r){o.push('<option value="{0}">{1}</option>'.format(r.id,r.name))}),o.join("")}function n(t){var r=[];r.push('<option value="">{0}</option>'.format("All Assignees"));for(var o=0;o<t.length;o++)r.push('<option value="{0}">{1}</option>'.format(t[o].key,t[o].name));return r.join("")}a(document).ready(function(){a(".gravityflow-reports-filter").each(function(){e=a(this).data("filter"),i=e.config;var t=e.selected,r=t.formId;if((a(this).find(".gravityflow-reports-category").toggle(!!r),r)&&"step"==t.category){a(this).find(".gravityflow-reports-steps").html(l(r));var o=t.stepId;if(a(this).find(".gravityflow-reports-steps").val(o),a(this).find(".gravityflow-reports-steps").show(),o){var s=i[r][o].assignees;a(this).find(".gravityflow-reports-assignees").html(n(s)),a(this).find(".gravityflow-reports-assignees").val(t.assignee),a(this).find(".gravityflow-reports-assignees").show()}}}),a(".gravityflow-reports-filter form").on("submit",function(t){if(!a("body").hasClass("wp-admin")){t.preventDefault();var r=a(this).parents(".gravityflow_workflow_reports");a.ajax({url:gravityflow_status_list_strings.ajaxurl,method:"POST",data:{action:"gravityflow_render_reports",nonce:a(this).find(".gravityflow-reports-nonce").val(),args:a(this).find(".gravityflow-reports-args").val(),data:a(this).serialize()},success:function(t){"error"===t.status?alert(t.message):(r.find("#gravityflow-reports").html(t),o.drawCharts())}})}}),a(".gravityflow-form-drop-down").change(function(){a(this).nextAll(".gravityflow-reports-category").toggle(!!this.value),this.value&&a(this).nextAll(".gravityflow-reports-category").val("month"),a(this).nextAll(".gravityflow-reports-steps").hide(),a("#gravityflow-reports-assignees").hide()}),a(".gravityflow-reports-category").change(function(){var t=a(this).prev(".gravityflow-form-drop-down").val();"step"==this.value?(a(this).nextAll(".gravityflow-reports-steps").html(l(t)),a(this).nextAll(".gravityflow-reports-steps").show()):(a("#gravityflow-reports-assignees").hide(),a(this).nextAll(".gravityflow-reports-steps").hide())}),a(".gravityflow-reports-steps").change(function(){if(this.value){var t=a(this).prevAll(".gravityflow-form-drop-down").val(),r=i[t][this.value].assignees;a(this).nextAll(".gravityflow-reports-assignees").html(n(r)),a(this).nextAll(".gravityflow-reports-assignees").show()}else a(this).nextAll(".gravityflow-reports-assignees").hide()})}),o.drawCharts=function(){a(".gravityflow_chart").each(function(){var t=a(this),r=t.data("table");if(void 0!==r){var o=google.visualization.arrayToDataTable(r),s=t.data("options"),e=t.data("type");new google.charts[e](this).draw(o,s)}})},String.prototype.format=function(){var o=arguments;return this.replace(/{(\d+)}/g,function(t,r){return void 0!==o[r]?o[r]:t})}}(window.Gravity_Flow_Reports=window.Gravity_Flow_Reports||{},jQuery),google.load("visualization","1.1",{packages:["bar"]}),google.setOnLoadCallback(Gravity_Flow_Reports.drawCharts);