!function(i,w){w(document).ready(function(){w(".gravityflow-actions-unlock").click(function(){var i=w(this),o=i.siblings(".gravityflow-actions-lock"),a=i.siblings(".gravityflow-actions-note-field-container"),s=i.siblings(".gravityflow-actions");i.hide(),o.show(),a.hide(),s.hide(),i.parent(".gravityflow-actions").addClass("gravityflow-actions-locked")}),w(".gravityflow-action").click(function(){var o=w(this),a=o.siblings(".gravityflow-actions-unlock"),s=o.siblings(".gravityflow-actions-lock"),i=o.siblings(".gravityflow-actions-note-field-container"),t=i.find("textarea"),n=o.data("note_field");if(!o.hasClass("gravityflow-action-processed")){if(o.parent(".gravityflow-actions").hasClass("gravityflow-actions-locked"))return o.parent(".gravityflow-actions").removeClass("gravityflow-actions-locked"),s.hide(),a.show(),void(n?(i.show(),t.focus(),w(document).keyup(function(i){27==i.keyCode&&a.click()})):setTimeout(function(){o.hasClass("gravityflow-action-processing")||o.hasClass("gravityflow-action-processed")||(o.parent(".gravityflow-actions").addClass("gravityflow-actions-locked"),s.show(),a.hide())},2e3));var e=parseInt(o.data("entry_id")),l=o.data("rest_base"),r=o.data("action"),c=gravityflow_inbox_strings.restUrl,f=gravityflow_inbox_strings.nonce,d=o.siblings(".gravityflow-actions-spinner");w.ajax({method:"POST",url:c+"gf/v2/entries/"+e+"/workflow/"+l,data:{action:r,gravityflow_note:t.val()},beforeSend:function(i){i.setRequestHeader("X-WP-Nonce",f),o.siblings().andSelf().hide(),o.addClass("gravityflow-action-processing"),d.show()},success:function(i){d.hide(),o.removeClass("gravityflow-action-processing"),"success"==i.status?(o.addClass("gravityflow-action-processed"),o.prop("title",i.feedback),o.show(),o.parent(".gravityflow-actions").removeClass("gravityflow-actions-locked")):(o.parent(".gravityflow-actions").addClass("gravityflow-actions-locked"),o.siblings(".gravityflow-action").andSelf().show(),s.show(),alert(i.feedback))},fail:function(i){d.hide(),a.hide(),s.show(),o.removeClass("gravityflow-action-processing"),o.siblings(".gravityflow-actions").andSelf().show(),alert(i)}})}})})}(window.GravityFlowInbox=window.GravityFlowInbox||{},jQuery);